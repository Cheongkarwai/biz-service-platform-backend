<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      lang="en">

<head>
    <title>Good Thymes Virtual Grocery</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link th:href="@{/output.css}" type="text/css" rel="stylesheet" />
    <script src="//unpkg.com/alpinejs" defer></script>

</head>
<body>
<div class="shadow-sm p-2">

<div x-data="carousel()" class="relative w-full max-w-xl mx-auto overflow-hidden rounded-md shadow-lg">

    <!-- Slides -->
    <div class="flex transition-transform duration-500" :style="`transform: translateX(-${activeIndex * 100}%);`">
        <div class="w-full flex-shrink-0" th:each="service: ${services}">
            <div class="p-10 bg-gray-200">
                <!-- First child content -->
                <p class="text-center text-2xl font-semibold" th:text="${service.name}"></p>
            </div>
            <div class="p-10 bg-gray-200 flex justify-center">
                <!-- Second child content -->
                <button th:data-service-id="${service.id}"  type="button" class="service-details-btn rounded-full bg-rose-400 px-4 py-2.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 dark:bg-rose-500 dark:text-white dark:shadow-none dark:ring-white/5 dark:hover:bg-rose-400">Select</button>
            </div>
        </div>
    </div>

    <button type="button" @click="prev" class="hs-carousel-prev hs-carousel-disabled:opacity-50 hs-carousel-disabled:cursor-default absolute top-1/2 start-2 inline-flex justify-center items-center size-10 bg-white border border-gray-100 text-gray-800 rounded-full shadow-2xs hover:bg-gray-100 -translate-y-1/2 focus:outline-hidden">
    <span class="text-2xl" aria-hidden="true">
      <svg class="shrink-0 size-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m15 18-6-6 6-6"></path>
      </svg>
    </span>
        <span class="sr-only">Previous</span>
    </button>
    <button type="button" @click="next" class="hs-carousel-next hs-carousel-disabled:opacity-50 hs-carousel-disabled:cursor-default absolute top-1/2 end-2 inline-flex justify-center items-center size-10 bg-white border border-gray-100 text-gray-800 rounded-full shadow-2xs hover:bg-gray-100 -translate-y-1/2 focus:outline-hidden">
        <span class="sr-only">Next</span>
        <span class="text-2xl" aria-hidden="true">
      <svg class="shrink-0 size-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="m9 18 6-6-6-6"></path>
      </svg>
    </span>
    </button>


    <!-- Dots -->
    <div class="absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-2">
        <template x-for="(slide, index) in slides" :key="index">
            <div @click="goTo(index)"
                 class="w-3 h-3 rounded-full cursor-pointer"
                 :class="activeIndex === index ? 'bg-blue-500' : 'bg-gray-300'"></div>
        </template>
    </div>
</div>

</div>
<script th:inline="javascript">
    document.addEventListener('click', function (event) {
        const btn = event.target.closest('.service-details-btn');
        if (!btn) return;

        const serviceId = btn.getAttribute('data-service-id');
        // Send the message to the parent window using the serviceId from the data attribute
        window.parent.postMessage({
            type: 'tool',
            payload: {
                toolName: 'getBusinessesByServiceId',
                params: { id: serviceId }
            }
        }, '*');
    });
    // setTimeout(() => {
    //     window.parent.postMessage({ type: "mcp-ui-resize", height: 5000 }, "*");
    // }, 500);
    function carousel() {
        return {
            activeIndex: 0,
            slides: /*[[${slides}]]*/,
            next() {
                this.activeIndex = (this.activeIndex + 1) % this.slides.length;
            },
            prev() {
                this.activeIndex = (this.activeIndex - 1 + this.slides.length) % this.slides.length;
            },
            goTo(index) {
                this.activeIndex = index;
            }
        }
    }
</script>
</body>
</html>